create table inv_unit_ufv_uyv with (PARTITIONS=16) as 
select
inv_unit_gkey,
inv_unit_id,
inv_unit_foreignhost_key,
inv_unit_visit_state,
inv_unit_needs_review,
inv_unit_placards_mismatched,
inv_unit_create_time,
inv_unit_declrd_ib_cv,
inv_unit_category,
inv_unit_freight_kind,
inv_unit_dray_status,
inv_unit_complex_gkey,
inv_unit_goods,
inv_unit_special_stow_gkey,
inv_unit_special_stow2_gkey,
inv_unit_special_stow3_gkey,
inv_unit_deck_rqmnt,
inv_unit_requires_power,
inv_unit_is_powered,
inv_unit_want_powered,
inv_unit_power_rqst_time,
inv_unit_is_alarm_on,
inv_unit_is_oog,
inv_unit_oog_back_cm,
inv_unit_oog_front_cm,
inv_unit_oog_left_cm,
inv_unit_oog_right_cm,
inv_unit_oog_top_cm,
inv_unit_vldt_rlgp,
inv_unit_xfer_rlgp,
inv_unit_line_op,
inv_unit_goods_and_ctr_wt_kg,
inv_unit_goods_ctr_wt_kg_advised,
inv_unit_goods_ctr_wt_kg_gate_measured,
inv_unit_goods_ctr_wt_kg_yard_measured,
inv_unit_ign_pyld_wghts,
inv_unit_ign_pyld_hghts,
inv_unit_is_stowplan_posted,
inv_unit_seal_nbr1,
inv_unit_seal_nbr2,
inv_unit_seal_nbr3,
inv_unit_seal_nbr4,
inv_unit_is_ctr_sealed,
inv_unit_is_bundle,
inv_unit_active_ufv,
inv_unit_primary_ue,
inv_unit_carriage_ue,
inv_unit_opl_gkey,
inv_unit_pol_gkey,
inv_unit_cv_gkey,
inv_unit_service_gkey,
inv_unit_pod1_gkey,
inv_unit_pod2_gkey,
inv_unit_opt1_gkey,
inv_unit_opt2_gkey,
inv_unit_opt3_gkey,
inv_unit_group_gkey,
inv_unit_description,
inv_unit_export_clearance_nbr,
inv_unit_return_to_location,
inv_unit_trucking_company,
inv_unit_pin_nbr,
inv_unit_bond_trucking_company,
inv_unit_bonded_destination,
inv_unit_ido_gkey,
inv_unit_ido_expiry_date,
inv_unit_time_denorm_calc,
inv_unit_time_state_change,
inv_unit_stopped_vessel,
inv_unit_stopped_rail,
inv_unit_stopped_road,
inv_unit_imped_vessel,
inv_unit_imped_rail,
inv_unit_imped_road,
inv_unit_remark,
inv_unit_way_bill_nbr,
inv_unit_way_bill_date,
inv_unit_export_release_nbr,
inv_unit_export_release_date,
inv_unit_flex_string01,
inv_unit_flex_string02,
inv_unit_flex_string03,
inv_unit_flex_string04,
inv_unit_flex_string05,
inv_unit_flex_string06,
inv_unit_flex_string07,
inv_unit_flex_string08,
inv_unit_flex_string09,
inv_unit_flex_string10,
inv_unit_flex_string11,
inv_unit_flex_string12,
inv_unit_flex_string13,
inv_unit_flex_string14,
inv_unit_flex_string15,
inv_unit_touch_ctr,
inv_unit_inbond,
inv_unit_exam,
inv_unit_acry_equip_ids,
inv_unit_customs_id,
inv_unit_agent1,
inv_unit_agent2,
inv_unit_changed,
inv_unit_cargo_quantity,
inv_unit_cargo_quantity_unit,
inv_unit_goods_ctr_wt_kg_qc_measured,
inv_unit_projected_pod_gkey,
inv_unit_CUSTDFF_PREAN_PROCESSED_TIME,
inv_unit_CUSTDFF_UNIT_IDOEXPIRES,
inv_unit_related_unit,
inv_unit_relationship_role,
inv_unit_unit_combo,
inv_unit_eq_gkey,
inv_unit_carriage_unit,
inv_unit_eqs_gkey,
inv_unit_damage,
inv_unit_sparcs_damage_code,
inv_unit_dmgs_gkey,
inv_unit_condition_gkey,
inv_unit_bad_nbr,
inv_unit_is_folded,
inv_unit_arrive_order_item_gkey,
inv_unit_depart_order_item_gkey,
inv_unit_is_reserved,
inv_unit_mnr_status_gkey,
inv_unit_placarded,
inv_unit_grade_gkey,
inv_unit_goods_ctr_wt_kg_vgm,
inv_unit_unit_gross_weight_source,
inv_unit_unit_vgm_entity,
inv_unit_unit_vgm_verified_date,
inv_unit_declrd_ib_cv_fk,
inv_unit_complex_gkey_fk,
inv_unit_goods_fk,
inv_unit_special_stow_gkey_fk,
inv_unit_special_stow2_gkey_fk,
inv_unit_special_stow3_gkey_fk,
inv_unit_line_op_fk,
case when inv_unit_active_ufv_fk is null then '0' else inv_unit_active_ufv_fk end as inv_unit_active_ufv_fk,
inv_unit_primary_ue_fk,
inv_unit_carriage_ue_fk,
inv_unit_opl_gkey_fk,
inv_unit_pol_gkey_fk,
inv_unit_cv_gkey_fk,
inv_unit_service_gkey_fk,
inv_unit_pod1_gkey_fk,
inv_unit_pod2_gkey_fk,
inv_unit_opt1_gkey_fk,
inv_unit_opt2_gkey_fk,
inv_unit_opt3_gkey_fk,
inv_unit_group_gkey_fk,
inv_unit_trucking_company_fk,
inv_unit_bond_trucking_company_fk,
inv_unit_ido_gkey_fk,
inv_unit_agent1_fk,
inv_unit_agent2_fk,
inv_unit_projected_pod_gkey_fk,
inv_unit_related_unit_fk,
inv_unit_unit_combo_fk,
inv_unit_eq_gkey_fk,
inv_unit_carriage_unit_fk,
inv_unit_eqs_gkey_fk,
inv_unit_dmgs_gkey_fk,
inv_unit_condition_gkey_fk,
inv_unit_arrive_order_item_gkey_fk,
inv_unit_depart_order_item_gkey_fk,
inv_unit_mnr_status_gkey_fk,
inv_unit_grade_gkey_fk,
inv_unit_multi_tenant_pk,
inv_unit_operation,
inv_unit_timestamp,
ufv_gkey,
ufv_horizon,
ufv_visit_state,
ufv_transit_state,
ufv_create_time,
ufv_arrive_pos_loctype,
ufv_arrive_pos_locid,
ufv_arrive_pos_loc_gkey,
ufv_arrive_pos_slot,
ufv_arrive_pos_orientation,
ufv_arrive_pos_name,
ufv_arrive_ops_pos_id,
ufv_arrive_pos_bin,
ufv_arrive_pos_tier,
ufv_arrive_pos_anchor,
ufv_arrive_pos_orientation_degrees,
ufv_last_pos_loctype,
ufv_last_pos_locid,
ufv_last_pos_loc_gkey,
ufv_last_pos_slot,
ufv_last_pos_orientation,
ufv_last_pos_name,
ufv_last_ops_pos_id,
ufv_last_pos_bin,
ufv_last_pos_tier,
ufv_last_pos_anchor,
ufv_last_pos_orientation_degrees,
ufv_time_move,
ufv_time_load,
ufv_time_rnd,
ufv_time_ecout,
ufv_time_in,
ufv_time_out,
ufv_time_dlv_appmnt,
ufv_time_inv,
ufv_time_complete,
ufv_unit_gkey,
ufv_fcy_gkey,
ufv_sequence,
ufv_intend_ob_cv,
ufv_restow_typ,
ufv_hndlg_rsn,
ufv_yrd_stwge,
ufv_sparcs_stopped,
ufv_sparcs_note,
ufv_has_changed,
ufv_vrfd_load,
ufv_vrfd_yard,
ufv_ed_anomaly,
ufv_actual_ib_cv,
ufv_actual_ob_cv,
ufv_last_free_day,
ufv_paid_thru_day,
ufv_guarantee_thru_day,
ufv_guarantee_party_gkey,
ufv_power_last_free_day,
ufv_power_paid_thru_day,
ufv_power_guarantee_thru_day,
ufv_power_guarantee_party_gkey,
ufv_line_last_free_day,
ufv_line_paid_thru_day,
ufv_line_guarantee_thru_day,
ufv_line_guarantee_party_gkey,
ufv_visible_sparcs,
ufv_flex_string01,
ufv_flex_string02,
ufv_flex_string03,
ufv_flex_string04,
ufv_flex_string05,
ufv_flex_string06,
ufv_flex_string07,
ufv_flex_string08,
ufv_flex_string09,
ufv_flex_string10,
ufv_flex_date01,
ufv_flex_date02,
ufv_flex_date03,
ufv_flex_date04,
ufv_flex_date05,
ufv_flex_date06,
ufv_flex_date07,
ufv_flex_date08,
ufv_is_direct_ib_to_ob_move,
ufv_validate_marry_errors,
ufv_stow_factor,
ufv_return_to_yard,
ufv_move_count,
ufv_ras_priority,
ufv_appt_nbr,
ufv_housekp_cur_slot,
ufv_housekp_ftr_slot,
ufv_housekp_cur_score,
ufv_housekp_ftr_score,
ufv_housekp_timestamp,
ufv_stacking_factor,
ufv_section_factor,
ufv_cas_unit_reference,
ufv_cas_tran_reference,
ufv_preferred_transfer_location,
ufv_door_direction,
ufv_optimal_rail_tz_slot,
ufv_carrier_incompatible_reason,
ufv_CUSTDFF_MONITORED,
ufv_CUSTDFF_DISCONNECT_MIN,
ufv_CUSTDFF_PRIORITY,
ufv_CUSTDFF_DUE_TIME,
ufv_CUSTDFF_LAST_UPDATE,
ufv_arrive_pos_slot_on_carriage,
ufv_last_pos_slot_on_carriage,
ufv_rail_cone_status,
ufv_segregation_factor,
ufv_changed,
ufv_has_active_alarm,
ufv_arrive_pos_bin_fk,
ufv_last_pos_bin_fk,
ufv_unit_gkey_fk,
ufv_fcy_gkey_fk,
ufv_intend_ob_cv_fk,
ufv_actual_ib_cv_fk,
ufv_actual_ob_cv_fk,
ufv_guarantee_party_gkey_fk,
ufv_power_guarantee_party_gkey_fk,
ufv_line_guarantee_party_gkey_fk,
case when ufv_multi_tenant_pk is null then '0' else ufv_multi_tenant_pk end as ufv_multi_tenant_pk,
ufv_operation,
ufv_timestamp,
uyv_gkey,
uyv_ufv_gkey,
uyv_yrd_gkey,
uyv_pkey,
case when uyv_ufv_gkey_fk is null then '0' else uyv_ufv_gkey_fk end as uyv_ufv_gkey_fk,
uyv_yrd_gkey_fk,
uyv_multi_tenant_pk,
uyv_operation,
uyv_timestamp
from INV_UNIT_INV_UNIT_FCY_VISIT_REKEYED left join inv_unit_yrd_visit on inv_unit_active_ufv_fk = uyv_ufv_gkey_fk;

create stream inv_unit_ufv_uyv_stream
(
inv_unit_gkey varchar,
inv_unit_id varchar,
inv_unit_foreignhost_key varchar,
inv_unit_visit_state varchar,
inv_unit_needs_review varchar,
inv_unit_placards_mismatched varchar,
inv_unit_create_time varchar,
inv_unit_declrd_ib_cv varchar,
inv_unit_category varchar,
inv_unit_freight_kind varchar,
inv_unit_dray_status varchar,
inv_unit_complex_gkey varchar,
inv_unit_goods varchar,
inv_unit_special_stow_gkey varchar,
inv_unit_special_stow2_gkey varchar,
inv_unit_special_stow3_gkey varchar,
inv_unit_deck_rqmnt varchar,
inv_unit_requires_power varchar,
inv_unit_is_powered varchar,
inv_unit_want_powered varchar,
inv_unit_power_rqst_time varchar,
inv_unit_is_alarm_on varchar,
inv_unit_is_oog varchar,
inv_unit_oog_back_cm varchar,
inv_unit_oog_front_cm varchar,
inv_unit_oog_left_cm varchar,
inv_unit_oog_right_cm varchar,
inv_unit_oog_top_cm varchar,
inv_unit_vldt_rlgp varchar,
inv_unit_xfer_rlgp varchar,
inv_unit_line_op varchar,
inv_unit_goods_and_ctr_wt_kg varchar,
inv_unit_goods_ctr_wt_kg_advised varchar,
inv_unit_goods_ctr_wt_kg_gate_measured varchar,
inv_unit_goods_ctr_wt_kg_yard_measured varchar,
inv_unit_ign_pyld_wghts varchar,
inv_unit_ign_pyld_hghts varchar,
inv_unit_is_stowplan_posted varchar,
inv_unit_seal_nbr1 varchar,
inv_unit_seal_nbr2 varchar,
inv_unit_seal_nbr3 varchar,
inv_unit_seal_nbr4 varchar,
inv_unit_is_ctr_sealed varchar,
inv_unit_is_bundle varchar,
inv_unit_active_ufv varchar,
inv_unit_primary_ue varchar,
inv_unit_carriage_ue varchar,
inv_unit_opl_gkey varchar,
inv_unit_pol_gkey varchar,
inv_unit_cv_gkey varchar,
inv_unit_service_gkey varchar,
inv_unit_pod1_gkey varchar,
inv_unit_pod2_gkey varchar,
inv_unit_opt1_gkey varchar,
inv_unit_opt2_gkey varchar,
inv_unit_opt3_gkey varchar,
inv_unit_group_gkey varchar,
inv_unit_description varchar,
inv_unit_export_clearance_nbr varchar,
inv_unit_return_to_location varchar,
inv_unit_trucking_company varchar,
inv_unit_pin_nbr varchar,
inv_unit_bond_trucking_company varchar,
inv_unit_bonded_destination varchar,
inv_unit_ido_gkey varchar,
inv_unit_ido_expiry_date varchar,
inv_unit_time_denorm_calc varchar,
inv_unit_time_state_change varchar,
inv_unit_stopped_vessel varchar,
inv_unit_stopped_rail varchar,
inv_unit_stopped_road varchar,
inv_unit_imped_vessel varchar,
inv_unit_imped_rail varchar,
inv_unit_imped_road varchar,
inv_unit_remark varchar,
inv_unit_way_bill_nbr varchar,
inv_unit_way_bill_date varchar,
inv_unit_export_release_nbr varchar,
inv_unit_export_release_date varchar,
inv_unit_flex_string01 varchar,
inv_unit_flex_string02 varchar,
inv_unit_flex_string03 varchar,
inv_unit_flex_string04 varchar,
inv_unit_flex_string05 varchar,
inv_unit_flex_string06 varchar,
inv_unit_flex_string07 varchar,
inv_unit_flex_string08 varchar,
inv_unit_flex_string09 varchar,
inv_unit_flex_string10 varchar,
inv_unit_flex_string11 varchar,
inv_unit_flex_string12 varchar,
inv_unit_flex_string13 varchar,
inv_unit_flex_string14 varchar,
inv_unit_flex_string15 varchar,
inv_unit_touch_ctr varchar,
inv_unit_inbond varchar,
inv_unit_exam varchar,
inv_unit_acry_equip_ids varchar,
inv_unit_customs_id varchar,
inv_unit_agent1 varchar,
inv_unit_agent2 varchar,
inv_unit_changed varchar,
inv_unit_cargo_quantity varchar,
inv_unit_cargo_quantity_unit varchar,
inv_unit_goods_ctr_wt_kg_qc_measured varchar,
inv_unit_projected_pod_gkey varchar,
inv_unit_CUSTDFF_PREAN_PROCESSED_TIME varchar,
inv_unit_CUSTDFF_UNIT_IDOEXPIRES varchar,
inv_unit_related_unit varchar,
inv_unit_relationship_role varchar,
inv_unit_unit_combo varchar,
inv_unit_eq_gkey varchar,
inv_unit_carriage_unit varchar,
inv_unit_eqs_gkey varchar,
inv_unit_damage varchar,
inv_unit_sparcs_damage_code varchar,
inv_unit_dmgs_gkey varchar,
inv_unit_condition_gkey varchar,
inv_unit_bad_nbr varchar,
inv_unit_is_folded varchar,
inv_unit_arrive_order_item_gkey varchar,
inv_unit_depart_order_item_gkey varchar,
inv_unit_is_reserved varchar,
inv_unit_mnr_status_gkey varchar,
inv_unit_placarded varchar,
inv_unit_grade_gkey varchar,
inv_unit_goods_ctr_wt_kg_vgm varchar,
inv_unit_unit_gross_weight_source varchar,
inv_unit_unit_vgm_entity varchar,
inv_unit_unit_vgm_verified_date varchar,
inv_unit_declrd_ib_cv_fk varchar,
inv_unit_complex_gkey_fk varchar,
inv_unit_goods_fk varchar,
inv_unit_special_stow_gkey_fk varchar,
inv_unit_special_stow2_gkey_fk varchar,
inv_unit_special_stow3_gkey_fk varchar,
inv_unit_line_op_fk varchar,
inv_unit_active_ufv_fk varchar,
inv_unit_primary_ue_fk varchar,
inv_unit_carriage_ue_fk varchar,
inv_unit_opl_gkey_fk varchar,
inv_unit_pol_gkey_fk varchar,
inv_unit_cv_gkey_fk varchar,
inv_unit_service_gkey_fk varchar,
inv_unit_pod1_gkey_fk varchar,
inv_unit_pod2_gkey_fk varchar,
inv_unit_opt1_gkey_fk varchar,
inv_unit_opt2_gkey_fk varchar,
inv_unit_opt3_gkey_fk varchar,
inv_unit_group_gkey_fk varchar,
inv_unit_trucking_company_fk varchar,
inv_unit_bond_trucking_company_fk varchar,
inv_unit_ido_gkey_fk varchar,
inv_unit_agent1_fk varchar,
inv_unit_agent2_fk varchar,
inv_unit_projected_pod_gkey_fk varchar,
inv_unit_related_unit_fk varchar,
inv_unit_unit_combo_fk varchar,
inv_unit_eq_gkey_fk varchar,
inv_unit_carriage_unit_fk varchar,
inv_unit_eqs_gkey_fk varchar,
inv_unit_dmgs_gkey_fk varchar,
inv_unit_condition_gkey_fk varchar,
inv_unit_arrive_order_item_gkey_fk varchar,
inv_unit_depart_order_item_gkey_fk varchar,
inv_unit_mnr_status_gkey_fk varchar,
inv_unit_grade_gkey_fk varchar,
inv_unit_multi_tenant_pk varchar,
inv_unit_operation varchar,
inv_unit_timestamp varchar,
ufv_gkey varchar,
ufv_horizon varchar,
ufv_visit_state varchar,
ufv_transit_state varchar,
ufv_create_time varchar,
ufv_arrive_pos_loctype varchar,
ufv_arrive_pos_locid varchar,
ufv_arrive_pos_loc_gkey varchar,
ufv_arrive_pos_slot varchar,
ufv_arrive_pos_orientation varchar,
ufv_arrive_pos_name varchar,
ufv_arrive_ops_pos_id varchar,
ufv_arrive_pos_bin varchar,
ufv_arrive_pos_tier varchar,
ufv_arrive_pos_anchor varchar,
ufv_arrive_pos_orientation_degrees varchar,
ufv_last_pos_loctype varchar,
ufv_last_pos_locid varchar,
ufv_last_pos_loc_gkey varchar,
ufv_last_pos_slot varchar,
ufv_last_pos_orientation varchar,
ufv_last_pos_name varchar,
ufv_last_ops_pos_id varchar,
ufv_last_pos_bin varchar,
ufv_last_pos_tier varchar,
ufv_last_pos_anchor varchar,
ufv_last_pos_orientation_degrees varchar,
ufv_time_move varchar,
ufv_time_load varchar,
ufv_time_rnd varchar,
ufv_time_ecout varchar,
ufv_time_in varchar,
ufv_time_out varchar,
ufv_time_dlv_appmnt varchar,
ufv_time_inv varchar,
ufv_time_complete varchar,
ufv_unit_gkey varchar,
ufv_fcy_gkey varchar,
ufv_sequence varchar,
ufv_intend_ob_cv varchar,
ufv_restow_typ varchar,
ufv_hndlg_rsn varchar,
ufv_yrd_stwge varchar,
ufv_sparcs_stopped varchar,
ufv_sparcs_note varchar,
ufv_has_changed varchar,
ufv_vrfd_load varchar,
ufv_vrfd_yard varchar,
ufv_ed_anomaly varchar,
ufv_actual_ib_cv varchar,
ufv_actual_ob_cv varchar,
ufv_last_free_day varchar,
ufv_paid_thru_day varchar,
ufv_guarantee_thru_day varchar,
ufv_guarantee_party_gkey varchar,
ufv_power_last_free_day varchar,
ufv_power_paid_thru_day varchar,
ufv_power_guarantee_thru_day varchar,
ufv_power_guarantee_party_gkey varchar,
ufv_line_last_free_day varchar,
ufv_line_paid_thru_day varchar,
ufv_line_guarantee_thru_day varchar,
ufv_line_guarantee_party_gkey varchar,
ufv_visible_sparcs varchar,
ufv_flex_string01 varchar,
ufv_flex_string02 varchar,
ufv_flex_string03 varchar,
ufv_flex_string04 varchar,
ufv_flex_string05 varchar,
ufv_flex_string06 varchar,
ufv_flex_string07 varchar,
ufv_flex_string08 varchar,
ufv_flex_string09 varchar,
ufv_flex_string10 varchar,
ufv_flex_date01 varchar,
ufv_flex_date02 varchar,
ufv_flex_date03 varchar,
ufv_flex_date04 varchar,
ufv_flex_date05 varchar,
ufv_flex_date06 varchar,
ufv_flex_date07 varchar,
ufv_flex_date08 varchar,
ufv_is_direct_ib_to_ob_move varchar,
ufv_validate_marry_errors varchar,
ufv_stow_factor varchar,
ufv_return_to_yard varchar,
ufv_move_count varchar,
ufv_ras_priority varchar,
ufv_appt_nbr varchar,
ufv_housekp_cur_slot varchar,
ufv_housekp_ftr_slot varchar,
ufv_housekp_cur_score varchar,
ufv_housekp_ftr_score varchar,
ufv_housekp_timestamp varchar,
ufv_stacking_factor varchar,
ufv_section_factor varchar,
ufv_cas_unit_reference varchar,
ufv_cas_tran_reference varchar,
ufv_preferred_transfer_location varchar,
ufv_door_direction varchar,
ufv_optimal_rail_tz_slot varchar,
ufv_carrier_incompatible_reason varchar,
ufv_CUSTDFF_MONITORED varchar,
ufv_CUSTDFF_DISCONNECT_MIN varchar,
ufv_CUSTDFF_PRIORITY varchar,
ufv_CUSTDFF_DUE_TIME varchar,
ufv_CUSTDFF_LAST_UPDATE varchar,
ufv_arrive_pos_slot_on_carriage varchar,
ufv_last_pos_slot_on_carriage varchar,
ufv_rail_cone_status varchar,
ufv_segregation_factor varchar,
ufv_changed varchar,
ufv_has_active_alarm varchar,
ufv_arrive_pos_bin_fk varchar,
ufv_last_pos_bin_fk varchar,
ufv_unit_gkey_fk varchar,
ufv_fcy_gkey_fk varchar,
ufv_intend_ob_cv_fk varchar,
ufv_actual_ib_cv_fk varchar,
ufv_actual_ob_cv_fk varchar,
ufv_guarantee_party_gkey_fk varchar,
ufv_power_guarantee_party_gkey_fk varchar,
ufv_line_guarantee_party_gkey_fk varchar,
ufv_multi_tenant_pk varchar,
ufv_operation varchar,
ufv_timestamp varchar,
uyv_gkey varchar,
uyv_ufv_gkey varchar,
uyv_yrd_gkey varchar,
uyv_pkey varchar,
uyv_ufv_gkey_fk varchar,
uyv_yrd_gkey_fk varchar,
uyv_multi_tenant_pk varchar,
uyv_operation varchar,
uyv_timestamp varchar 
) WITH (KAFKA_TOPIC='INV_UNIT_UFV_UYV',VALUE_FORMAT='JSON');

create stream inv_unit_ufv_uyv_stream_rekeyed with (PARTITIONS=16)as 
select
inv_unit_gkey,
inv_unit_id,
inv_unit_foreignhost_key,
inv_unit_visit_state,
inv_unit_needs_review,
inv_unit_placards_mismatched,
inv_unit_create_time,
inv_unit_declrd_ib_cv,
inv_unit_category,
inv_unit_freight_kind,
inv_unit_dray_status,
inv_unit_complex_gkey,
inv_unit_goods,
inv_unit_special_stow_gkey,
inv_unit_special_stow2_gkey,
inv_unit_special_stow3_gkey,
inv_unit_deck_rqmnt,
inv_unit_requires_power,
inv_unit_is_powered,
inv_unit_want_powered,
inv_unit_power_rqst_time,
inv_unit_is_alarm_on,
inv_unit_is_oog,
inv_unit_oog_back_cm,
inv_unit_oog_front_cm,
inv_unit_oog_left_cm,
inv_unit_oog_right_cm,
inv_unit_oog_top_cm,
inv_unit_vldt_rlgp,
inv_unit_xfer_rlgp,
inv_unit_line_op,
inv_unit_goods_and_ctr_wt_kg,
inv_unit_goods_ctr_wt_kg_advised,
inv_unit_goods_ctr_wt_kg_gate_measured,
inv_unit_goods_ctr_wt_kg_yard_measured,
inv_unit_ign_pyld_wghts,
inv_unit_ign_pyld_hghts,
inv_unit_is_stowplan_posted,
inv_unit_seal_nbr1,
inv_unit_seal_nbr2,
inv_unit_seal_nbr3,
inv_unit_seal_nbr4,
inv_unit_is_ctr_sealed,
inv_unit_is_bundle,
inv_unit_active_ufv,
inv_unit_primary_ue,
inv_unit_carriage_ue,
inv_unit_opl_gkey,
inv_unit_pol_gkey,
inv_unit_cv_gkey,
inv_unit_service_gkey,
inv_unit_pod1_gkey,
inv_unit_pod2_gkey,
inv_unit_opt1_gkey,
inv_unit_opt2_gkey,
inv_unit_opt3_gkey,
inv_unit_group_gkey,
inv_unit_description,
inv_unit_export_clearance_nbr,
inv_unit_return_to_location,
inv_unit_trucking_company,
inv_unit_pin_nbr,
inv_unit_bond_trucking_company,
inv_unit_bonded_destination,
inv_unit_ido_gkey,
inv_unit_ido_expiry_date,
inv_unit_time_denorm_calc,
inv_unit_time_state_change,
inv_unit_stopped_vessel,
inv_unit_stopped_rail,
inv_unit_stopped_road,
inv_unit_imped_vessel,
inv_unit_imped_rail,
inv_unit_imped_road,
inv_unit_remark,
inv_unit_way_bill_nbr,
inv_unit_way_bill_date,
inv_unit_export_release_nbr,
inv_unit_export_release_date,
inv_unit_flex_string01,
inv_unit_flex_string02,
inv_unit_flex_string03,
inv_unit_flex_string04,
inv_unit_flex_string05,
inv_unit_flex_string06,
inv_unit_flex_string07,
inv_unit_flex_string08,
inv_unit_flex_string09,
inv_unit_flex_string10,
inv_unit_flex_string11,
inv_unit_flex_string12,
inv_unit_flex_string13,
inv_unit_flex_string14,
inv_unit_flex_string15,
inv_unit_touch_ctr,
inv_unit_inbond,
inv_unit_exam,
inv_unit_acry_equip_ids,
inv_unit_customs_id,
inv_unit_agent1,
inv_unit_agent2,
inv_unit_changed,
inv_unit_cargo_quantity,
inv_unit_cargo_quantity_unit,
inv_unit_goods_ctr_wt_kg_qc_measured,
inv_unit_projected_pod_gkey,
inv_unit_CUSTDFF_PREAN_PROCESSED_TIME,
inv_unit_CUSTDFF_UNIT_IDOEXPIRES,
inv_unit_related_unit,
inv_unit_relationship_role,
inv_unit_unit_combo,
inv_unit_eq_gkey,
inv_unit_carriage_unit,
inv_unit_eqs_gkey,
inv_unit_damage,
inv_unit_sparcs_damage_code,
inv_unit_dmgs_gkey,
inv_unit_condition_gkey,
inv_unit_bad_nbr,
inv_unit_is_folded,
inv_unit_arrive_order_item_gkey,
inv_unit_depart_order_item_gkey,
inv_unit_is_reserved,
inv_unit_mnr_status_gkey,
inv_unit_placarded,
inv_unit_grade_gkey,
inv_unit_goods_ctr_wt_kg_vgm,
inv_unit_unit_gross_weight_source,
inv_unit_unit_vgm_entity,
inv_unit_unit_vgm_verified_date,
inv_unit_declrd_ib_cv_fk,
inv_unit_complex_gkey_fk,
inv_unit_goods_fk,
inv_unit_special_stow_gkey_fk,
inv_unit_special_stow2_gkey_fk,
inv_unit_special_stow3_gkey_fk,
inv_unit_line_op_fk,
inv_unit_active_ufv_fk,
inv_unit_primary_ue_fk,
inv_unit_carriage_ue_fk,
inv_unit_opl_gkey_fk,
inv_unit_pol_gkey_fk,
inv_unit_cv_gkey_fk,
inv_unit_service_gkey_fk,
inv_unit_pod1_gkey_fk,
inv_unit_pod2_gkey_fk,
inv_unit_opt1_gkey_fk,
inv_unit_opt2_gkey_fk,
inv_unit_opt3_gkey_fk,
inv_unit_group_gkey_fk,
inv_unit_trucking_company_fk,
inv_unit_bond_trucking_company_fk,
inv_unit_ido_gkey_fk,
inv_unit_agent1_fk,
inv_unit_agent2_fk,
inv_unit_projected_pod_gkey_fk,
inv_unit_related_unit_fk,
inv_unit_unit_combo_fk,
case when inv_unit_eq_gkey_fk is null then '0' else inv_unit_eq_gkey_fk end as inv_unit_eq_gkey_fk,
inv_unit_carriage_unit_fk,
inv_unit_eqs_gkey_fk,
inv_unit_dmgs_gkey_fk,
inv_unit_condition_gkey_fk,
inv_unit_arrive_order_item_gkey_fk,
inv_unit_depart_order_item_gkey_fk,
inv_unit_mnr_status_gkey_fk,
inv_unit_grade_gkey_fk,
inv_unit_multi_tenant_pk,
inv_unit_operation,
inv_unit_timestamp,
ufv_gkey,
ufv_horizon,
ufv_visit_state,
ufv_transit_state,
ufv_create_time,
ufv_arrive_pos_loctype,
ufv_arrive_pos_locid,
ufv_arrive_pos_loc_gkey,
ufv_arrive_pos_slot,
ufv_arrive_pos_orientation,
ufv_arrive_pos_name,
ufv_arrive_ops_pos_id,
ufv_arrive_pos_bin,
ufv_arrive_pos_tier,
ufv_arrive_pos_anchor,
ufv_arrive_pos_orientation_degrees,
ufv_last_pos_loctype,
ufv_last_pos_locid,
ufv_last_pos_loc_gkey,
ufv_last_pos_slot,
ufv_last_pos_orientation,
ufv_last_pos_name,
ufv_last_ops_pos_id,
ufv_last_pos_bin,
ufv_last_pos_tier,
ufv_last_pos_anchor,
ufv_last_pos_orientation_degrees,
ufv_time_move,
ufv_time_load,
ufv_time_rnd,
ufv_time_ecout,
ufv_time_in,
ufv_time_out,
ufv_time_dlv_appmnt,
ufv_time_inv,
ufv_time_complete,
ufv_unit_gkey,
ufv_fcy_gkey,
ufv_sequence,
ufv_intend_ob_cv,
ufv_restow_typ,
ufv_hndlg_rsn,
ufv_yrd_stwge,
ufv_sparcs_stopped,
ufv_sparcs_note,
ufv_has_changed,
ufv_vrfd_load,
ufv_vrfd_yard,
ufv_ed_anomaly,
ufv_actual_ib_cv,
ufv_actual_ob_cv,
ufv_last_free_day,
ufv_paid_thru_day,
ufv_guarantee_thru_day,
ufv_guarantee_party_gkey,
ufv_power_last_free_day,
ufv_power_paid_thru_day,
ufv_power_guarantee_thru_day,
ufv_power_guarantee_party_gkey,
ufv_line_last_free_day,
ufv_line_paid_thru_day,
ufv_line_guarantee_thru_day,
ufv_line_guarantee_party_gkey,
ufv_visible_sparcs,
ufv_flex_string01,
ufv_flex_string02,
ufv_flex_string03,
ufv_flex_string04,
ufv_flex_string05,
ufv_flex_string06,
ufv_flex_string07,
ufv_flex_string08,
ufv_flex_string09,
ufv_flex_string10,
ufv_flex_date01,
ufv_flex_date02,
ufv_flex_date03,
ufv_flex_date04,
ufv_flex_date05,
ufv_flex_date06,
ufv_flex_date07,
ufv_flex_date08,
ufv_is_direct_ib_to_ob_move,
ufv_validate_marry_errors,
ufv_stow_factor,
ufv_return_to_yard,
ufv_move_count,
ufv_ras_priority,
ufv_appt_nbr,
ufv_housekp_cur_slot,
ufv_housekp_ftr_slot,
ufv_housekp_cur_score,
ufv_housekp_ftr_score,
ufv_housekp_timestamp,
ufv_stacking_factor,
ufv_section_factor,
ufv_cas_unit_reference,
ufv_cas_tran_reference,
ufv_preferred_transfer_location,
ufv_door_direction,
ufv_optimal_rail_tz_slot,
ufv_carrier_incompatible_reason,
ufv_CUSTDFF_MONITORED,
ufv_CUSTDFF_DISCONNECT_MIN,
ufv_CUSTDFF_PRIORITY,
ufv_CUSTDFF_DUE_TIME,
ufv_CUSTDFF_LAST_UPDATE,
ufv_arrive_pos_slot_on_carriage,
ufv_last_pos_slot_on_carriage,
ufv_rail_cone_status,
ufv_segregation_factor,
ufv_changed,
ufv_has_active_alarm,
ufv_arrive_pos_bin_fk,
ufv_last_pos_bin_fk,
ufv_unit_gkey_fk,
ufv_fcy_gkey_fk,
ufv_intend_ob_cv_fk,
ufv_actual_ib_cv_fk,
ufv_actual_ob_cv_fk,
ufv_guarantee_party_gkey_fk,
ufv_power_guarantee_party_gkey_fk,
ufv_line_guarantee_party_gkey_fk,
ufv_multi_tenant_pk,
ufv_operation,
ufv_timestamp,
uyv_gkey,
uyv_ufv_gkey,
uyv_yrd_gkey,
uyv_pkey,
uyv_ufv_gkey_fk,
uyv_yrd_gkey_fk,
uyv_multi_tenant_pk,
uyv_operation,
uyv_timestamp from INV_UNIT_UFV_UYV_STREAM partition by inv_unit_eq_gkey_fk;


create table inv_unit_ufv_uyv_rekeyed (
inv_unit_gkey varchar,
inv_unit_id varchar,
inv_unit_foreignhost_key varchar,
inv_unit_visit_state varchar,
inv_unit_needs_review varchar,
inv_unit_placards_mismatched varchar,
inv_unit_create_time varchar,
inv_unit_declrd_ib_cv varchar,
inv_unit_category varchar,
inv_unit_freight_kind varchar,
inv_unit_dray_status varchar,
inv_unit_complex_gkey varchar,
inv_unit_goods varchar,
inv_unit_special_stow_gkey varchar,
inv_unit_special_stow2_gkey varchar,
inv_unit_special_stow3_gkey varchar,
inv_unit_deck_rqmnt varchar,
inv_unit_requires_power varchar,
inv_unit_is_powered varchar,
inv_unit_want_powered varchar,
inv_unit_power_rqst_time varchar,
inv_unit_is_alarm_on varchar,
inv_unit_is_oog varchar,
inv_unit_oog_back_cm varchar,
inv_unit_oog_front_cm varchar,
inv_unit_oog_left_cm varchar,
inv_unit_oog_right_cm varchar,
inv_unit_oog_top_cm varchar,
inv_unit_vldt_rlgp varchar,
inv_unit_xfer_rlgp varchar,
inv_unit_line_op varchar,
inv_unit_goods_and_ctr_wt_kg varchar,
inv_unit_goods_ctr_wt_kg_advised varchar,
inv_unit_goods_ctr_wt_kg_gate_measured varchar,
inv_unit_goods_ctr_wt_kg_yard_measured varchar,
inv_unit_ign_pyld_wghts varchar,
inv_unit_ign_pyld_hghts varchar,
inv_unit_is_stowplan_posted varchar,
inv_unit_seal_nbr1 varchar,
inv_unit_seal_nbr2 varchar,
inv_unit_seal_nbr3 varchar,
inv_unit_seal_nbr4 varchar,
inv_unit_is_ctr_sealed varchar,
inv_unit_is_bundle varchar,
inv_unit_active_ufv varchar,
inv_unit_primary_ue varchar,
inv_unit_carriage_ue varchar,
inv_unit_opl_gkey varchar,
inv_unit_pol_gkey varchar,
inv_unit_cv_gkey varchar,
inv_unit_service_gkey varchar,
inv_unit_pod1_gkey varchar,
inv_unit_pod2_gkey varchar,
inv_unit_opt1_gkey varchar,
inv_unit_opt2_gkey varchar,
inv_unit_opt3_gkey varchar,
inv_unit_group_gkey varchar,
inv_unit_description varchar,
inv_unit_export_clearance_nbr varchar,
inv_unit_return_to_location varchar,
inv_unit_trucking_company varchar,
inv_unit_pin_nbr varchar,
inv_unit_bond_trucking_company varchar,
inv_unit_bonded_destination varchar,
inv_unit_ido_gkey varchar,
inv_unit_ido_expiry_date varchar,
inv_unit_time_denorm_calc varchar,
inv_unit_time_state_change varchar,
inv_unit_stopped_vessel varchar,
inv_unit_stopped_rail varchar,
inv_unit_stopped_road varchar,
inv_unit_imped_vessel varchar,
inv_unit_imped_rail varchar,
inv_unit_imped_road varchar,
inv_unit_remark varchar,
inv_unit_way_bill_nbr varchar,
inv_unit_way_bill_date varchar,
inv_unit_export_release_nbr varchar,
inv_unit_export_release_date varchar,
inv_unit_flex_string01 varchar,
inv_unit_flex_string02 varchar,
inv_unit_flex_string03 varchar,
inv_unit_flex_string04 varchar,
inv_unit_flex_string05 varchar,
inv_unit_flex_string06 varchar,
inv_unit_flex_string07 varchar,
inv_unit_flex_string08 varchar,
inv_unit_flex_string09 varchar,
inv_unit_flex_string10 varchar,
inv_unit_flex_string11 varchar,
inv_unit_flex_string12 varchar,
inv_unit_flex_string13 varchar,
inv_unit_flex_string14 varchar,
inv_unit_flex_string15 varchar,
inv_unit_touch_ctr varchar,
inv_unit_inbond varchar,
inv_unit_exam varchar,
inv_unit_acry_equip_ids varchar,
inv_unit_customs_id varchar,
inv_unit_agent1 varchar,
inv_unit_agent2 varchar,
inv_unit_changed varchar,
inv_unit_cargo_quantity varchar,
inv_unit_cargo_quantity_unit varchar,
inv_unit_goods_ctr_wt_kg_qc_measured varchar,
inv_unit_projected_pod_gkey varchar,
inv_unit_CUSTDFF_PREAN_PROCESSED_TIME varchar,
inv_unit_CUSTDFF_UNIT_IDOEXPIRES varchar,
inv_unit_related_unit varchar,
inv_unit_relationship_role varchar,
inv_unit_unit_combo varchar,
inv_unit_eq_gkey varchar,
inv_unit_carriage_unit varchar,
inv_unit_eqs_gkey varchar,
inv_unit_damage varchar,
inv_unit_sparcs_damage_code varchar,
inv_unit_dmgs_gkey varchar,
inv_unit_condition_gkey varchar,
inv_unit_bad_nbr varchar,
inv_unit_is_folded varchar,
inv_unit_arrive_order_item_gkey varchar,
inv_unit_depart_order_item_gkey varchar,
inv_unit_is_reserved varchar,
inv_unit_mnr_status_gkey varchar,
inv_unit_placarded varchar,
inv_unit_grade_gkey varchar,
inv_unit_goods_ctr_wt_kg_vgm varchar,
inv_unit_unit_gross_weight_source varchar,
inv_unit_unit_vgm_entity varchar,
inv_unit_unit_vgm_verified_date varchar,
inv_unit_declrd_ib_cv_fk varchar,
inv_unit_complex_gkey_fk varchar,
inv_unit_goods_fk varchar,
inv_unit_special_stow_gkey_fk varchar,
inv_unit_special_stow2_gkey_fk varchar,
inv_unit_special_stow3_gkey_fk varchar,
inv_unit_line_op_fk varchar,
inv_unit_active_ufv_fk varchar,
inv_unit_primary_ue_fk varchar,
inv_unit_carriage_ue_fk varchar,
inv_unit_opl_gkey_fk varchar,
inv_unit_pol_gkey_fk varchar,
inv_unit_cv_gkey_fk varchar,
inv_unit_service_gkey_fk varchar,
inv_unit_pod1_gkey_fk varchar,
inv_unit_pod2_gkey_fk varchar,
inv_unit_opt1_gkey_fk varchar,
inv_unit_opt2_gkey_fk varchar,
inv_unit_opt3_gkey_fk varchar,
inv_unit_group_gkey_fk varchar,
inv_unit_trucking_company_fk varchar,
inv_unit_bond_trucking_company_fk varchar,
inv_unit_ido_gkey_fk varchar,
inv_unit_agent1_fk varchar,
inv_unit_agent2_fk varchar,
inv_unit_projected_pod_gkey_fk varchar,
inv_unit_related_unit_fk varchar,
inv_unit_unit_combo_fk varchar,
inv_unit_eq_gkey_fk varchar,
inv_unit_carriage_unit_fk varchar,
inv_unit_eqs_gkey_fk varchar,
inv_unit_dmgs_gkey_fk varchar,
inv_unit_condition_gkey_fk varchar,
inv_unit_arrive_order_item_gkey_fk varchar,
inv_unit_depart_order_item_gkey_fk varchar,
inv_unit_mnr_status_gkey_fk varchar,
inv_unit_grade_gkey_fk varchar,
inv_unit_multi_tenant_pk varchar,
inv_unit_operation varchar,
inv_unit_timestamp varchar,
ufv_gkey varchar,
ufv_horizon varchar,
ufv_visit_state varchar,
ufv_transit_state varchar,
ufv_create_time varchar,
ufv_arrive_pos_loctype varchar,
ufv_arrive_pos_locid varchar,
ufv_arrive_pos_loc_gkey varchar,
ufv_arrive_pos_slot varchar,
ufv_arrive_pos_orientation varchar,
ufv_arrive_pos_name varchar,
ufv_arrive_ops_pos_id varchar,
ufv_arrive_pos_bin varchar,
ufv_arrive_pos_tier varchar,
ufv_arrive_pos_anchor varchar,
ufv_arrive_pos_orientation_degrees varchar,
ufv_last_pos_loctype varchar,
ufv_last_pos_locid varchar,
ufv_last_pos_loc_gkey varchar,
ufv_last_pos_slot varchar,
ufv_last_pos_orientation varchar,
ufv_last_pos_name varchar,
ufv_last_ops_pos_id varchar,
ufv_last_pos_bin varchar,
ufv_last_pos_tier varchar,
ufv_last_pos_anchor varchar,
ufv_last_pos_orientation_degrees varchar,
ufv_time_move varchar,
ufv_time_load varchar,
ufv_time_rnd varchar,
ufv_time_ecout varchar,
ufv_time_in varchar,
ufv_time_out varchar,
ufv_time_dlv_appmnt varchar,
ufv_time_inv varchar,
ufv_time_complete varchar,
ufv_unit_gkey varchar,
ufv_fcy_gkey varchar,
ufv_sequence varchar,
ufv_intend_ob_cv varchar,
ufv_restow_typ varchar,
ufv_hndlg_rsn varchar,
ufv_yrd_stwge varchar,
ufv_sparcs_stopped varchar,
ufv_sparcs_note varchar,
ufv_has_changed varchar,
ufv_vrfd_load varchar,
ufv_vrfd_yard varchar,
ufv_ed_anomaly varchar,
ufv_actual_ib_cv varchar,
ufv_actual_ob_cv varchar,
ufv_last_free_day varchar,
ufv_paid_thru_day varchar,
ufv_guarantee_thru_day varchar,
ufv_guarantee_party_gkey varchar,
ufv_power_last_free_day varchar,
ufv_power_paid_thru_day varchar,
ufv_power_guarantee_thru_day varchar,
ufv_power_guarantee_party_gkey varchar,
ufv_line_last_free_day varchar,
ufv_line_paid_thru_day varchar,
ufv_line_guarantee_thru_day varchar,
ufv_line_guarantee_party_gkey varchar,
ufv_visible_sparcs varchar,
ufv_flex_string01 varchar,
ufv_flex_string02 varchar,
ufv_flex_string03 varchar,
ufv_flex_string04 varchar,
ufv_flex_string05 varchar,
ufv_flex_string06 varchar,
ufv_flex_string07 varchar,
ufv_flex_string08 varchar,
ufv_flex_string09 varchar,
ufv_flex_string10 varchar,
ufv_flex_date01 varchar,
ufv_flex_date02 varchar,
ufv_flex_date03 varchar,
ufv_flex_date04 varchar,
ufv_flex_date05 varchar,
ufv_flex_date06 varchar,
ufv_flex_date07 varchar,
ufv_flex_date08 varchar,
ufv_is_direct_ib_to_ob_move varchar,
ufv_validate_marry_errors varchar,
ufv_stow_factor varchar,
ufv_return_to_yard varchar,
ufv_move_count varchar,
ufv_ras_priority varchar,
ufv_appt_nbr varchar,
ufv_housekp_cur_slot varchar,
ufv_housekp_ftr_slot varchar,
ufv_housekp_cur_score varchar,
ufv_housekp_ftr_score varchar,
ufv_housekp_timestamp varchar,
ufv_stacking_factor varchar,
ufv_section_factor varchar,
ufv_cas_unit_reference varchar,
ufv_cas_tran_reference varchar,
ufv_preferred_transfer_location varchar,
ufv_door_direction varchar,
ufv_optimal_rail_tz_slot varchar,
ufv_carrier_incompatible_reason varchar,
ufv_CUSTDFF_MONITORED varchar,
ufv_CUSTDFF_DISCONNECT_MIN varchar,
ufv_CUSTDFF_PRIORITY varchar,
ufv_CUSTDFF_DUE_TIME varchar,
ufv_CUSTDFF_LAST_UPDATE varchar,
ufv_arrive_pos_slot_on_carriage varchar,
ufv_last_pos_slot_on_carriage varchar,
ufv_rail_cone_status varchar,
ufv_segregation_factor varchar,
ufv_changed varchar,
ufv_has_active_alarm varchar,
ufv_arrive_pos_bin_fk varchar,
ufv_last_pos_bin_fk varchar,
ufv_unit_gkey_fk varchar,
ufv_fcy_gkey_fk varchar,
ufv_intend_ob_cv_fk varchar,
ufv_actual_ib_cv_fk varchar,
ufv_actual_ob_cv_fk varchar,
ufv_guarantee_party_gkey_fk varchar,
ufv_power_guarantee_party_gkey_fk varchar,
ufv_line_guarantee_party_gkey_fk varchar,
ufv_multi_tenant_pk varchar,
ufv_operation varchar,
ufv_timestamp varchar,
uyv_gkey varchar,
uyv_ufv_gkey varchar,
uyv_yrd_gkey varchar,
uyv_pkey varchar,
uyv_ufv_gkey_fk varchar,
uyv_yrd_gkey_fk varchar,
uyv_multi_tenant_pk varchar,
uyv_operation varchar,
uyv_timestamp varchar
) WITH (KAFKA_TOPIC='INV_UNIT_UFV_UYV_STREAM_REKEYED',VALUE_FORMAT='JSON',KEY='inv_unit_eq_gkey_fk');
